<script src="Cryptography.js"></script>
<script>


Cryptography.BITS_BASE = 0x10;
Cryptography.BASE = 0x10000;
Cryptography.MAX_DIGIT = 0xFFFF;

Cryptography.BITS_BASE = 0xC;
Cryptography.BASE = 0x1000;
Cryptography.MAX_DIGIT = 0xFFF;

Cryptography.BITS_BASE = 0x8;
Cryptography.BASE = 0x100;
Cryptography.MAX_DIGIT = 0xFF;

Cryptography.BITS_BASE = 0x2;
Cryptography.BASE = 0x4;
Cryptography.MAX_DIGIT = 0x3;

Cryptography.BITS_BASE = 0x4;
Cryptography.BASE = 0x10;
Cryptography.MAX_DIGIT = 0xF;


var zero = [];
var one = [1];
var two = [2];
var rnd1024 = Cryptography.random(64, 16);
var rnd2048 = Cryptography.random(128, 16);

// Addition

var r = Cryptography.add(zero, zero);
if (r.length != 0) {
	throw "0+0 failed";
}
var r = Cryptography.add(zero, one);
if (Cryptography.compare(r, one) != 0 || r[r.length-1]==0) {
	throw "0+1 failed";
}
var r = Cryptography.add(one, zero);
if (Cryptography.compare(r, one) != 0 || r[r.length-1]==0) {
	throw "1+0 failed";
}
var r = Cryptography.add(one, one);
if (Cryptography.compare(r, two) != 0 || r[r.length-1]==0) {
	throw "1+1 failed";
}
var r = Cryptography.add(rnd1024, rnd1024);
var r = Cryptography.shiftRight(r,1);
if (Cryptography.compare(r, rnd1024) != 0 || r[r.length-1]==0) {
	throw "rnd1024+rnd1024 failed";
}
var r = Cryptography.add(rnd2048, rnd1024);
var r2 = Cryptography.add(rnd1024, rnd2048);
var r3 = Cryptography.subtract(r, rnd1024);
if (Cryptography.compare(r, r2) != 0 || r[r.length-1]==0 
		|| Cryptography.compare(r3, rnd2048) != 0) {
	throw "rnd2048+rnd1024 failed";
} 	

// Subtraction	

var r = Cryptography.subtract(zero, zero);
if (r.length != 0) {
	throw "0-0 failed";
}
var r = Cryptography.subtract(one, zero);
if (Cryptography.compare(r, one) != 0 || r[r.length-1]==0) {
	throw "1-0 failed";
}
test = false;
try { var r = Cryptography.subtract(zero, one); } catch(e) { test = true; }
if (!test) {
	throw "0-1 did not raise an exception";
}
var r = Cryptography.subtract(one, one);
if (r.length != 0) {
	throw "1-1 failed";
}
var r = Cryptography.subtract(rnd1024, rnd1024);
if (r.length != 0) {
	throw "rnd1024-rnd1024 failed";
}
test = false;
try { var r = Cryptography.subtract(rnd1024, rnd2048); } catch(e) { test = true; }
if (!test) {
	throw "rnd1024-rnd2048 did not raise an exception";
}

// Multiplication	

var r = Cryptography.multiply(zero, zero);
if (r.length != 0) {
	throw "0*0 failed";
}
var r = Cryptography.multiply(zero, one);
var r2 = Cryptography.multiply(one, zero);
if (Cryptography.compare(r, r2) != 0 || r.length != 0) {
	throw "0*1/1*0 failed";
}
var r = Cryptography.multiply(one, one);
if (Cryptography.compare(r, one) != 0 || r[r.length-1]==0) {
	throw "1*1 failed";
}
var r = Cryptography.multiply(rnd1024, zero);
var r2 = Cryptography.multiply(zero, rnd1024);
if (Cryptography.compare(r, r2) != 0 || r.length != 0) {
	throw "rnd1024*0 failed";
}
var r = Cryptography.multiply(rnd1024, one);
var r2 = Cryptography.multiply(one, rnd1024);
if (Cryptography.compare(r, rnd1024) != 0 || Cryptography.compare(r, r2) != 0
		|| r[r.length-1]==0) {
	throw "rnd1024*1 failed";
}
var r = Cryptography.multiply(rnd1024, rnd1024);
var r2 = Cryptography.divide(r, rnd1024);
if (Cryptography.compare(r2, rnd1024) != 0 || r[r.length-1]==0) {
	throw "rnd1024*rnd1024 failed";
}
var r = Cryptography.multiply(rnd2048, rnd1024);
var r2 = Cryptography.multiply(rnd1024, rnd2048);
var r3 = Cryptography.divide(r, rnd2048);
if (Cryptography.compare(r, r2) != 0 || r[r.length-1]==0 || r3.remainder.length!=0  
		|| Cryptography.compare(r3.quotient, rnd1024) != 0) {
	throw "rnd2048*rnd1024 failed";
} 	

// Division	

test = false;
try { var r = Cryptography.divide(zero, zero); } catch(e) { test = true; }
if (!test) {
	throw "0/0 did not raise an exception";
}
test = false;
try { var r = Cryptography.divide(one, zero); } catch(e) { test = true; }
if (!test) {
	throw "1/0 did not raise an exception";
}
test = false;
try { var r = Cryptography.divide(rnd1024, zero); } catch(e) { test = true; }
if (!test) {
	throw "rnd1024/0 did not raise an exception";
}
var r = Cryptography.divide(zero, one);
if (r.quotient.length != 0 || r.remainder.length != 0) {
	throw "1/0 failed";
}
var r = Cryptography.divide(zero, rnd1024);
if (r.quotient.length != 0 || r.remainder.length != 0) {
	throw "rnd1024/0 failed";
}
var r = Cryptography.divide(rnd1024, one);
if (Cryptography.compare(r.quotient, rnd1024) != 0 
		|| r.quotient[r.quotient.length-1]==0 || r.remainder.length != 0) {
	throw "rnd1024/1 failed";
}
var r = Cryptography.divide(rnd1024, rnd1024);
if (Cryptography.compare(r.quotient, one) != 0 
		|| r.quotient[r.quotient.length-1]==0 || r.remainder.length != 0) {
	throw "rnd1024/rnd1024 failed";
}
var r = Cryptography.divide(rnd2048, rnd1024);
var r2 = Cryptography.add(Cryptography.multiply(rnd1024, r.quotient), r.remainder);
if (r.quotient[r.quotient.length-1]==0 || r.remainder[r.remainder.length-1]==0
		|| Cryptography.compare(r, r2) != 0) {
	throw "rnd2048/rnd1024 failed";
}
var r = Cryptography.divide(rnd1024, rnd2048);
var r2 = Cryptography.add(Cryptography.multiply(rnd2048, r.quotient), r.remainder);
if (r.quotient[r.quotient.length-1]==0 || r.remainder[r.remainder.length-1]==0
		|| Cryptography.compare(r, r2) != 0) {
	throw "rnd2048/rnd1024 failed";
}

document.write("Tests passed");

</script>

